
<!DOCTYPE html>
<html lang="en" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>linux安全加固思路总结 - Guoyanan</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Fechin,"> 
    <meta name="description" content="Expect Us,0x01 前言​    Linux作为物联网领域的主流底层操作系统，安全问题将会愈发严峻。要想将linux的安全问题解决，得从它的运行、功能等多方面角度来分析，从而解决那些显而易见的安全问题。Lin,"> 
    <meta name="author" content="John Doe"> 
    <link rel="alternative" href="atom.xml" title="Guoyanan" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

    
<link rel="stylesheet" href="/css/diaspora.css">

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({
              google_ad_client: "ca-pub-8691406134231910",
              enable_page_level_ads: true
         });
    </script>
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
<meta name="generator" content="Hexo 4.2.1"></head>

<body class="loading">
    <span id="config-title" style="display:none">Guoyanan</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="http://yoursite.com"></a>
    <div title="播放/暂停" class="iconfont icon-play"></div>
    <h3 class="subtitle">linux安全加固思路总结</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">linux安全加固思路总结</h1>
        <div class="stuff">
            <span>十月 04, 2021</span>
            

        </div>
        <div class="content markdown">
            <h1 id="0x01-前言"><a href="#0x01-前言" class="headerlink" title="0x01 前言"></a>0x01 前言</h1><p>​    Linux作为物联网领域的主流底层操作系统，安全问题将会愈发严峻。要想将linux的安全问题解决，得从它的运行、功能等多方面角度来分析，从而解决那些显而易见的安全问题。Linux有很多发行的版本，目前大部分用的是centos6.5 、7，其次是Ubuntu16、14等。系统之间存在差异，但安全的大体方向是相同的。</p>
<p>​    关于linux的更多动态和知识，可以参考：<a href="https://www.linuxidc.com/" target="_blank" rel="noopener">https://www.linuxidc.com/</a></p>
<h1 id="0x02-帐号管理"><a href="#0x02-帐号管理" class="headerlink" title="0x02 帐号管理"></a>0x02 帐号管理</h1><h2 id="1、密码设置"><a href="#1、密码设置" class="headerlink" title="1、密码设置"></a>1、密码设置</h2><ul>
<li>避免弱口令</li>
<li>口令设置有效期</li>
<li>是否有人长时间猜测口令</li>
<li>自检自查。JOHN、crack等暴力工具。</li>
<li>在BIOS设置中设定一个BIOS密码，不接收软盘启动。这样可以阻止他人用专门的启动盘启动你的Linux系统，并避免BIOS设置被更改</li>
</ul>
<h2 id="2、shadow文件"><a href="#2、shadow文件" class="headerlink" title="2、shadow文件"></a>2、shadow文件</h2><p>​    /etc/shadow 文件，用于存储 Linux 系统中用户的密码信息，又称为“影子文件”。</p>
<p>​    /etc/shadow 文件只有 root 用户拥有读权限，其他用户没有任何权限，这样就保证了用户密码的安全性。    </p>
<p>​    与 /etc/passwd 文件不同的是，/etc/passwd 允许所有用户读取。<br>​    为了安全起见，需定期检查shadow文件的内容，例如是否存在空口令。</p>
<p>​    该文件各字段含义：<strong>用户名：加密密码：最后一次修改时间：最小修改时间间隔：密码有效期：密码需要变更前的警告天数：密码过期后的宽限时间：账号失效时间：保留字段</strong></p>
<h2 id="3、密码管理"><a href="#3、密码管理" class="headerlink" title="3、密码管理"></a>3、密码管理</h2><ul>
<li><p>设置口令有效最长时限 （编辑/etc/login.defs文件）</p>
</li>
<li><p>口令最短字符（如linux默认为５，可以通过编辑/etc/login.defs修改）</p>
</li>
<li><p>只允许特定用户使用su命令成为root。</p>
</li>
<li><p>编辑/etc/pam.d/su文件，在文件头部加上：</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#This allows root to su without passwords (normal operation)</span><br><span class="line"></span><br><span class="line">auth sufficient &#x2F;lib&#x2F;security&#x2F;pam_rootok.so debug  </span><br><span class="line"></span><br><span class="line">auth required &#x2F;lib&#x2F;security&#x2F;pam_wheel.so group&#x3D;wheel  </span><br><span class="line">&#x2F;&#x2F;这表明只有wheel组的成员可以使用su命令成为root用户。你可以把用户添加到wheel组，以使它可以使用su命令成为root用户。</span><br></pre></td></tr></table></figure>



<h2 id="4、账户清理"><a href="#4、账户清理" class="headerlink" title="4、账户清理"></a>4、账户清理</h2><ul>
<li>清除不必要的系统帐户</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">userdel lp</span><br><span class="line"></span><br><span class="line">userdel adm</span><br><span class="line"></span><br><span class="line">userdel sync</span><br><span class="line"></span><br><span class="line">userdel shutdown</span><br><span class="line"></span><br><span class="line">userdel halt</span><br><span class="line"></span><br><span class="line">userdel news</span><br><span class="line"></span><br><span class="line">userdel uucp</span><br><span class="line"></span><br><span class="line">userdel operator</span><br><span class="line"></span><br><span class="line">userdel gopher</span><br><span class="line"></span><br><span class="line">userdel games  (如果不使用 X Window，则删除)</span><br><span class="line"></span><br><span class="line">userdel ftp    （如果不使用ftp服务则删除）</span><br><span class="line"></span><br><span class="line">修改shadow,passwd,gshadow文件不可改变位</span><br><span class="line"></span><br><span class="line">chattr +i &#x2F;etc&#x2F;passwd  &#x2F;&#x2F;不允许修改。若是目录，则不允许新建、删除文件</span><br><span class="line"></span><br><span class="line">chattr +i &#x2F;etc&#x2F;shadow</span><br><span class="line"></span><br><span class="line">chattr +i &#x2F;etc&#x2F;group</span><br><span class="line"></span><br><span class="line">chattr +i &#x2F;etc&#x2F;gshadow</span><br></pre></td></tr></table></figure>

<ul>
<li><p>不要使用.netrc文件（可被用来自动地ftp）</p>
</li>
<li><p>使用ssh来代替telnetd,ftpd.pop等传统的网络服务程序，因为它们在网络上用明文传送口令和数据。 </p>
</li>
</ul>
<h1 id="0x03-服务管理"><a href="#0x03-服务管理" class="headerlink" title="0x03 服务管理"></a>0x03 服务管理</h1><p>​    对外开放的服务是很多安全问题的根源。针对这一点，主要就是两个原则：</p>
<p><strong>①只开放需要的服务②不同的服务部署在不同的主机上</strong>。</p>
<ul>
<li><p>nmap测试主机对外暴露的服务</p>
</li>
<li><p>若不需要开放，则需禁止的服务：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">       NAME     PORT    PROTOCOL            </span><br><span class="line">      echo       7        TCP&#x2F;UDP    </span><br><span class="line">   systat     11        TCP	    </span><br><span class="line">   netstat    15        TCP	        </span><br><span class="line">   bootp      67        UDP       </span><br><span class="line">   tftp       69        UDP	    </span><br><span class="line">   link       87        TCP       </span><br><span class="line">   supdup     95        TCP      </span><br><span class="line">   sunrpc     111      TCP&#x2F;UDP	     </span><br><span class="line">   news       144        TCP	    </span><br><span class="line">   snmp       161        UDP        </span><br><span class="line">   xdmcp      177        UDP       </span><br><span class="line">   exec       512        TCP  </span><br><span class="line">login      513        TCP</span><br><span class="line">   shell      514        TCP</span><br><span class="line">   printer    515        TCP</span><br><span class="line">   biff       512        UDP</span><br><span class="line">   who        513        UDP</span><br><span class="line">   syslog     514        UDP</span><br><span class="line">   uucp       540        TCP</span><br><span class="line">   route      520        UDP</span><br><span class="line">   openwin    2000      TCP</span><br><span class="line">   nfs        2049     UDP&#x2F;TCP</span><br><span class="line">   x11   6000 to 6000+n   TCP</span><br></pre></td></tr></table></figure>

<p>还有一些其它需要注意的文件或服务。</p>
</li>
<li><p>/etc/inetd.conf</p>
<p>该文件告诉 inetd监听哪些网络端口，为每个端口启动哪个服务。把 Linux系统放在任何网络环境中，要做的第一件事就 是了解服务器到底提供哪些服务。不需要的服务应该被禁止掉，最好卸载掉。</p>
</li>
<li><p>R服务</p>
<p>若不必使用R服务</p>
<ul>
<li><p>关闭R服务,Red hat 6.2在/etc/inetd.conf文件中注释以下服务，并且重新启动inetd服务。Red hat 7.0则在/etc/xinetd.d目录中删除Rlogin        513            TCP，Rshell        514            TCP</p>
</li>
<li><p>预先生成$HOME/.rhosts，/etc/hosts.equiv文件，并且设置为0000,防止被写入”+ +”。（攻击者经常使用类似符号链接或者利用ROOTSHELL写入，并且远程打开受保护主机的R服务）</p>
</li>
</ul>
<p>若必须使用R服务</p>
<ul>
<li><p>使用更安全版本的R服务。如Wietse Venema的logdaemon程序等。</p>
</li>
<li><p>在路由或者防火墙上禁止外部网络访问受保护主机的512,513,514 (TCP)端口。</p>
</li>
<li><p>使用TCP WRAPPERS设置可访问受保护主机R服务的信任机器。</p>
</li>
</ul>
</li>
<li><p>tcp_wrappers的设置（TCP_Wrappers:对有状态连接的特定服务进行安全检测并实现访问控制 以库文件形式实现）</p>
</li>
<li><p>/etc/hosts.equiv（权限、属主、删改，下面的文件也一样）</p>
</li>
<li><p>/etc/services</p>
</li>
<li><p>/etc/aliases</p>
</li>
<li><p>禁止NIS/NIS+服务以守护方式运行</p>
</li>
<li><p>禁止打印服务以守护方式运行</p>
</li>
<li><p>禁止SENDMAIL服务以守护方式运行</p>
</li>
<li><p>禁用不必要的标准启动服务</p>
</li>
</ul>
<h1 id="0x04-系统设置"><a href="#0x04-系统设置" class="headerlink" title="0x04 系统设置"></a>0x04 系统设置</h1><h2 id="1、限制控制台的使用"><a href="#1、限制控制台的使用" class="headerlink" title="1、限制控制台的使用"></a>1、限制控制台的使用</h2><p>禁止使用控制台程序：删除/etc/security/console.apps中的服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">rm -f &#x2F;etc&#x2F;security&#x2F;console.apps&#x2F;servicename，</span><br><span class="line"></span><br><span class="line">rm -f &#x2F;etc&#x2F;security&#x2F;console.apps&#x2F;halt</span><br><span class="line"></span><br><span class="line">rm -f &#x2F;etc&#x2F;security&#x2F;console.apps&#x2F;poweroff</span><br><span class="line"></span><br><span class="line">rm -f &#x2F;etc&#x2F;security&#x2F;console.apps&#x2F;reboot</span><br><span class="line"></span><br><span class="line">rm -f &#x2F;etc&#x2F;security&#x2F;console.apps&#x2F;shutdown</span><br><span class="line"></span><br><span class="line">rm -f &#x2F;etc&#x2F;security&#x2F;console.apps&#x2F;xserver</span><br></pre></td></tr></table></figure>

<p>禁止控制台的访问：在/etc/pam.d中的所有文件中，给包含pam_console.so的行加上注释</p>
<h2 id="2、系统关闭Ping"><a href="#2、系统关闭Ping" class="headerlink" title="2、系统关闭Ping"></a>2、系统关闭Ping</h2><p>关闭ping，使系统对ping不做反应，对网络安全大有好处。</p>
<p>可以使用如下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo 1 &gt; &#x2F;proc&#x2F;sys&#x2F;net&#x2F;ipv4&#x2F;icmp_echo_ignore_all</span><br></pre></td></tr></table></figure>

<p>可以将这一行加到/etc/rc.d/rc.local文件中去，这样系统重启动后会自动执行</p>
<p>恢复系统的Ping响应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo 0 &gt; &#x2F;proc&#x2F;sys&#x2F;net&#x2F;ipv4&#x2F;icmp_echo_ignore_all</span><br></pre></td></tr></table></figure>

<h2 id="3、关闭或更改系统信息"><a href="#3、关闭或更改系统信息" class="headerlink" title="3、关闭或更改系统信息"></a>3、关闭或更改系统信息</h2><p>关闭telnet系统信息：</p>
<p>​    在Red Hat 6.2中,编辑/etc/inetd.conf</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet stream tcp nowait root &#x2F;usr&#x2F;sbin&#x2F;tcpd in.telnetd –h</span><br></pre></td></tr></table></figure>

<p>加上参数-h可以关闭telnet信息。</p>
<p>​        在Red Hat 7.0中,编辑/etc/xinetd.d/telnet。加上</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server_args &#x3D; -h</span><br></pre></td></tr></table></figure>

<p>,可以关闭telnet信息。</p>
<p>​        在/etc/rc.d/rc.local中关闭或修改系统信息：</p>
<p>​        /etc/issue和/etc/issue.net中包含本地登录和网络登录时提示的系统信息,对它们进行更改可以改变系统信息。</p>
<p>​        也可以直接删除,并在/etc/rc.d/rc.local文件中注释相关行:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;&quot; &gt; &#x2F;etc&#x2F;issue</span><br><span class="line"></span><br><span class="line">echo &quot;$R&quot; &gt;&gt; &#x2F;etc&#x2F;issue</span><br><span class="line"></span><br><span class="line">echo &quot;Kernel $(uname -r) on $a $(uname -m)&quot; &gt;&gt; &#x2F;etc&#x2F;issue</span><br><span class="line"></span><br><span class="line">cp -f &#x2F;etc&#x2F;issue &#x2F;etc&#x2F;issue.net</span><br><span class="line"></span><br><span class="line">echo &gt;&gt; &#x2F;etc&#x2F;issue</span><br></pre></td></tr></table></figure>

<h2 id="4、etc-securetty文件"><a href="#4、etc-securetty文件" class="headerlink" title="4、etc/securetty文件"></a>4、etc/securetty文件</h2><p>/etc/securetty文件规定root从哪个TTY设备登录,列出的是允许的tty设备,将不允许的tty设备行注释掉.</p>
<h2 id="5、etc-host-conf文件"><a href="#5、etc-host-conf文件" class="headerlink" title="5、etc/host.conf文件"></a>5、etc/host.conf文件</h2><p>/etc/host.conf定义主机名怎样解析,使用什么服务,什么顺序解析</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Lookup names via DNS first then fall back to &#x2F;etc&#x2F;hosts.</span><br><span class="line"></span><br><span class="line">order bind,hosts</span><br><span class="line"></span><br><span class="line"># We have machines with multiple IP addresses.</span><br><span class="line"></span><br><span class="line">multi on</span><br><span class="line"></span><br><span class="line"># Check for IP address spoofing.</span><br><span class="line"></span><br><span class="line">nospoof on</span><br></pre></td></tr></table></figure>

<p>order指定选择服务的顺序</p>
<p>multi指定主机能不能有多个IP地址,ON代表允许</p>
<p>nospoof指定不允许IP伪装,此参数必须设置为ON</p>
<h2 id="6、禁止IP源路径路由"><a href="#6、禁止IP源路径路由" class="headerlink" title="6、禁止IP源路径路由"></a>6、禁止IP源路径路由</h2><p>允许IP源路径路由(IP source routing)会使得黑客能够欺骗你的计算机,截取信息包，强烈建议禁止，使用如下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">for f in &#x2F;proc&#x2F;sys&#x2F;net&#x2F;ipv4&#x2F;conf&#x2F;*&#x2F;accept_source_route; do</span><br><span class="line"></span><br><span class="line">echo 0 &gt; $f</span><br><span class="line"></span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p>将accept_source_route设置为0，并将上述命令加到/etc/rc.d/rc.local中去，每次重启动将自动执行。</p>
<h2 id="7、资源限制（防DDOS）"><a href="#7、资源限制（防DDOS）" class="headerlink" title="7、资源限制（防DDOS）"></a>7、资源限制（防DDOS）</h2><p>为了避免拒绝服务攻击，需要对系统资源的使用做一些限制。</p>
<p>首先，编辑/etc/security/limits.conf，加入或改变如下</p>
<p>* hard core 0     （禁止创建core文件）</p>
<p>* hard rss 5000    （除root外，其他用户最多使用5M内存）</p>
<p>* hard nproc 20    （最多进程数限制为20）</p>
<p>编辑/etc/pam.d/login,在文件末尾加上：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session required &#x2F;lib&#x2F;security&#x2F;pam_limits.so</span><br></pre></td></tr></table></figure>

<p>对TCP SYN Cookie的保护：（防止SYN Flood攻击）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo 1 &gt; &#x2F;proc&#x2F;sys&#x2F;net&#x2F;ipv4&#x2F;tcp_syncookies</span><br></pre></td></tr></table></figure>

<h2 id="8、LILO安全"><a href="#8、LILO安全" class="headerlink" title="8、LILO安全"></a>8、LILO安全</h2><p>LILO（Linux Loader)，即Linux引导程序。LILO是一个在系统启动时运行的程序，它用于选择引导计算机启动的操作系统。</p>
<p>在“/etc/lilo.conf”文件中添加3个参数：time-out、restricted 和 password。这些选项会在启动时间（如“linux single”）转到启动转载程序过程中，要求提供密码。</p>
<p>步骤1</p>
<p>编辑lilo.conf文件(vi　/etc/lilo.comf),加入或改变这三个参数：</p>
<p>　　boot=/dev/hda</p>
<p>　　map=/boot/map</p>
<p>　　install=/boot/boot.b</p>
<p>　　time-out=00　　　   #把这行该为00</p>
<p>　　prompt</p>
<p>　　Default=linux</p>
<p>　　restricted　　　        #加入这行</p>
<p>　　password=xxx　　　#加入这行并设置自己的密码</p>
<p>　　image=/boot/vmlinuz-2.2.14-12</p>
<p>　　label=linux</p>
<p>　　initrd=/boot/initrd-2.2.14-12.img</p>
<p>　　root=/dev/hda6</p>
<p>　　read-only</p>
<p>步骤2</p>
<p>因为”/etc/lilo.conf”文件中包含明文密码，所以要把它设置为root权限读取。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 600 &#x2F;etc&#x2F;lilo.conf （不再为全局可读）</span><br></pre></td></tr></table></figure>

<p>步骤3</p>
<p>作了上述修改后，更新配置文件“/etc/lilo.conf”。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;sbin&#x2F;lilo -v （更新lilo.conf文件）</span><br></pre></td></tr></table></figure>

<p>步骤4</p>
<p>使用”chattr”命令使”/etc/lilo.conf”文件变为不可改变。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chattr +i &#x2F;etc&#x2F;lilo.conf</span><br></pre></td></tr></table></figure>

<p>它将阻止任何对“lilo.conf”文件的更改。</p>
<h2 id="9、Control-Alt-Delete键盘关机命令"><a href="#9、Control-Alt-Delete键盘关机命令" class="headerlink" title="9、Control-Alt-Delete键盘关机命令"></a>9、Control-Alt-Delete键盘关机命令</h2><p>编辑“/etc/inittab”文件，只要在下面行前面加“＃”，改为注释行。</p>
<p>ca::ctrlaltdel:/sbin/shutdown -t3 -r now </p>
<p>然后，为使更改生效，在提示符下输入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;sbin&#x2F;init q</span><br></pre></td></tr></table></figure>

<h2 id="10、日志系统安全"><a href="#10、日志系统安全" class="headerlink" title="10、日志系统安全"></a>10、日志系统安全</h2><p>为了保证日志系统的完整性，防止黑客删除日志，需要对日志系统进行安全配置。</p>
<h2 id="11、修正脚本文件在-etc-rc-d-init-d”目录下的权限"><a href="#11、修正脚本文件在-etc-rc-d-init-d”目录下的权限" class="headerlink" title="11、修正脚本文件在/etc/rc.d/init.d”目录下的权限"></a>11、修正脚本文件在/etc/rc.d/init.d”目录下的权限</h2><p>对脚本文件的权限进行修正，脚本文件用以决定启动时需要运行的所有正常过程的开启和停止。添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod -R 700 &#x2F;etc&#x2F;rc.d&#x2F;init.d&#x2F;*</span><br></pre></td></tr></table></figure>



<h1 id="0x05-文件系统"><a href="#0x05-文件系统" class="headerlink" title="0x05 文件系统"></a>0x05 文件系统</h1><h2 id="1、文件权限"><a href="#1、文件权限" class="headerlink" title="1、文件权限"></a>1、文件权限</h2><p>(SUID 是 Set User ID, SGID 是 Set Group ID的意思。)</p>
<ul>
<li>去掉不必要的suid程序，可以通过脚本查看</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -type f \( -perm -04000 -o -perm -02000 \) \-exec ls –lg &#123;&#125;\;</span><br></pre></td></tr></table></figure>

<p>通过下面的命令来去掉不需要的程序的‘s’位(所有用户都不再具有s权限)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod a-s &#x2F;usr&#x2F;bin&#x2F;commandname</span><br></pre></td></tr></table></figure>

<ul>
<li><p>重要的配置文件如/etc/passwd,/etc/shadow,/etc/inetd.conf等设置为0755,并设置为不可更改</p>
</li>
<li><p>/etc, /usr/etc, /bin, /usr/bin, /sbin, /usr/sbin, /tmp and/var/tmp的属主是root,并且设置粘滞（设置了粘滞位后，只有目录内文件的所有者或者root才可以删除或移动该文件。）。</p>
</li>
<li><p>/dev目录下没有特殊文件。</p>
</li>
<li><p>查找任何人可写的文件和目录</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -type f \( -perm -2 -o -perm -20 \) -exec ls -lg &#123;&#125; \;</span><br><span class="line"></span><br><span class="line">find &#x2F; -type d \( -perm -2 -o -perm -20 \) -exec ls -ldg &#123;&#125; \;</span><br></pre></td></tr></table></figure>

<ul>
<li>查找异常文件，如..文件，…文件等</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -name &quot;.. &quot; -print –xdev</span><br><span class="line"></span><br><span class="line">find &#x2F; -name &quot;.*&quot; -print -xdev | cat -v</span><br></pre></td></tr></table></figure>

<ul>
<li>检查没有属主的文件。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -nouser –o –nogroup</span><br></pre></td></tr></table></figure>

<ul>
<li>检查在/dev目录以外还有没有特殊的块文件</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; \( -type b -o -type c \) -print | grep -v &#39;^&#x2F;dev&#x2F;&#39;</span><br></pre></td></tr></table></figure>

<ul>
<li>使用checksum  md5 或者PGP来效验文件</li>
</ul>
<h2 id="2、控制mount上的文件系统"><a href="#2、控制mount上的文件系统" class="headerlink" title="2、控制mount上的文件系统"></a>2、控制mount上的文件系统</h2><p>可以使用noexec, nodev, nosuid来控制mount上的文件系统.在/etc/fstab中设置，比如：</p>
<p>将/dev/sda11 /tmp ext2 defaults 1 2</p>
<p>/dev/sda6 /home ext2 defaults 1 2</p>
<p>改为：/dev/sda11 /tmp ext2 nosuid,nodev,noexec 1 2</p>
<p>/dev/sda6 /home ext2 nosuid,nodev 1 2</p>
<p>noexec表示不允许可执行，nodev表示不允许块设备，nosuid表示不允许suid位</p>
<h2 id="3、备份与恢复"><a href="#3、备份与恢复" class="headerlink" title="3、备份与恢复"></a>3、备份与恢复</h2><p>​    定期对文件系统进行备份，可以将损失减小到最小程度。</p>
<p>​    Linux下有多种方法进行备份，如：dd, cpio, tar, dump等</p>
<h1 id="0x06-iptables的使用"><a href="#0x06-iptables的使用" class="headerlink" title="0x06 iptables的使用"></a>0x06 iptables的使用</h1><ul>
<li>安装iptables</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install iptables-services</span><br></pre></td></tr></table></figure>

<ul>
<li>关闭</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl stopfirewalld.service</span><br><span class="line"></span><br><span class="line">systemctl disablefirewalld.servic</span><br></pre></td></tr></table></figure>

<ul>
<li>查看现有规则</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -L</span><br></pre></td></tr></table></figure>

<ul>
<li>清空所有默认规则</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -F</span><br></pre></td></tr></table></figure>

<ul>
<li>清空所有自定义规则</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -X</span><br></pre></td></tr></table></figure>

<ul>
<li>所有计数器清零</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -Z</span><br></pre></td></tr></table></figure>

<ul>
<li>允许来自于lo接口的数据包本地访问</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -I lo -jACCEPT</span><br></pre></td></tr></table></figure>

<ul>
<li>指定开放22端口</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp–dport 22 -j ACCEPT</span><br></pre></td></tr></table></figure>

<ul>
<li>禁止111.111.11.1 IP地址访问</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -s 111.111.11.1 -p tcp-dport 22 -j DROP</span><br></pre></td></tr></table></figure>

<ul>
<li>开放固定IP访问8080</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT -s 111.111.11.1 -p tcp –dport 8080 -j ACCEPT</span><br></pre></td></tr></table></figure>

<ul>
<li>禁止ping</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p icmp–icmp-type 8 -s 0&#x2F;0 -j DROP</span><br></pre></td></tr></table></figure>

<ul>
<li>添加内网IP信任</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp -s 10.0.0.2 -j ACCEPT</span><br></pre></td></tr></table></figure>

<ul>
<li>允许接受本机请求之后的返回数据RELATED</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -m state–state RELATED,ESTABLISHED -j ACCEPT</span><br></pre></td></tr></table></figure>

<ul>
<li>限制流量</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -I eth0-m limit --limit 5&#x2F;m –limit-burst 15 -j ACCEPT</span><br></pre></td></tr></table></figure>

<ul>
<li>特定时间内匹配</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -i eth0-m time --weekdays 1,3,5 -j ACCEPT</span><br></pre></td></tr></table></figure>

<ul>
<li>匹配符合规则的TTL值得数据包</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A OUTPUT -m ttl–ttl-eq 51 -j ACCEPT</span><br></pre></td></tr></table></figure>

<ul>
<li>匹配指定的状态数据包</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -m state --stateNEW,ESTABLISHED -j ACCETP</span><br></pre></td></tr></table></figure>

<ul>
<li>匹配带有指定的mark值的数据包</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -t mangle -A INPUT-m mark --mark 1 -j DROP</span><br></pre></td></tr></table></figure>

<ul>
<li>匹配指定的mac地址</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptable -A FORWARD -m mac --mac-source 00:0C:22:38:49:61 -j DROP</span><br></pre></td></tr></table></figure>

<ul>
<li>映射端口(将mysql默认的3306端口映射到1306对外提供服务)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -t mangle -IPREROUTING -p tcp -dport 1306 -j MARK --set-mark 3306</span><br></pre></td></tr></table></figure>

<ul>
<li>过滤所有非以上规则的请求</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -P INPUT DROP</span><br></pre></td></tr></table></figure>

<ul>
<li>保存iptables规则</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service iptables save</span><br></pre></td></tr></table></figure>

<ul>
<li>自动开启iptables服务</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enableiptables.service</span><br></pre></td></tr></table></figure>

<ul>
<li>查看状态</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status iptables.service</span><br></pre></td></tr></table></figure>



<h1 id="0x07-日志管理"><a href="#0x07-日志管理" class="headerlink" title="0x07 日志管理"></a>0x07 日志管理</h1><h2 id="1、syslog登录事件"><a href="#1、syslog登录事件" class="headerlink" title="1、syslog登录事件"></a>1、syslog登录事件</h2><p><code>more /etc/syslog.conf</code></p>
<p>查看参数authpriv值。若未对所有登录事件都记录，则低于安全要求。</p>
<h2 id="2、syslog-conf的配置审核"><a href="#2、syslog-conf的配置审核" class="headerlink" title="2、syslog.conf的配置审核"></a>2、syslog.conf的配置审核</h2><p>  执行：<code>more /etc/syslog.conf</code>，</p>
<p>查看是否设置了下列项： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">kern.warning;</span><br><span class="line">*.err;</span><br><span class="line">authpriv.none\t@loghost  </span><br><span class="line">*.info;</span><br><span class="line">mail.none;</span><br><span class="line">authpriv.none;</span><br><span class="line">cron.none\t@loghost  </span><br><span class="line">*.emerg\t@loghost  </span><br><span class="line">local7.*\t@loghost</span><br></pre></td></tr></table></figure>

<p>若未设置，则低于安全要求。</p>
<h2 id="3、非日志服务器禁止接收syslog、"><a href="#3、非日志服务器禁止接收syslog、" class="headerlink" title="3、非日志服务器禁止接收syslog、"></a>3、非日志服务器禁止接收syslog、</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;rc.config.d&#x2F;syslogd</span><br></pre></td></tr></table></figure>

<p>检查是否存在SYSLOGD_OPTS=”-N”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ch_rc -a -p SYSLOGD_OPTS&#x3D;&quot;-N&quot; &#x2F;etc&#x2F;rc.config.d&#x2F;syslogd</span><br></pre></td></tr></table></figure>

<h2 id="4、启用inetd日志记录"><a href="#4、启用inetd日志记录" class="headerlink" title="4、启用inetd日志记录"></a>4、启用inetd日志记录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;rc.config.d&#x2F;netdaemons | grep INETD_ARGS&#x3D;-l</span><br></pre></td></tr></table></figure>

<p>查看该文件是否存在INETD_ARGS=-l</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ch_rc -a -p INETD_ARGS&#x3D;-l &#x2F;etc&#x2F;rc.config.d&#x2F;netdaemons</span><br></pre></td></tr></table></figure>

<h2 id="5、检查日志文件权限"><a href="#5、检查日志文件权限" class="headerlink" title="5、检查日志文件权限"></a>5、检查日志文件权限</h2><p>使用chmod配置相关文件的权限即可。</p>
<h1 id="0x08-协议配置"><a href="#0x08-协议配置" class="headerlink" title="0x08 协议配置"></a>0x08 协议配置</h1><h2 id="1、关闭IP转发"><a href="#1、关闭IP转发" class="headerlink" title="1、关闭IP转发"></a>1、关闭IP转发</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ndd -get &#x2F;dev&#x2F;ip ip_forwarding</span><br></pre></td></tr></table></figure>

<p>查看是否关闭IP转发，返回值应为0</p>
<p>操作：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1、备份</span><br><span class="line">cp -p &#x2F;etc&#x2F;rc.config.d&#x2F;nddconf &#x2F;etc&#x2F;rc.config.d&#x2F;nddconf_bak</span><br><span class="line">2、执行下列命令，设置参数</span><br><span class="line">使参数在当前系统状态下临时生效：</span><br><span class="line">ndd -set &#x2F;dev&#x2F;ip ip_forwarding 0</span><br><span class="line">建立启动项，使参数重启后永久生效：</span><br><span class="line">cd &#x2F;etc&#x2F;rc.config.d</span><br><span class="line">cat &lt;&lt;EOF &gt;&gt; nddconf</span><br><span class="line"># Don&#39;t ip forwarding</span><br><span class="line">TRANSPORT_NAME[0]&#x3D;ip</span><br><span class="line">NDD_NAME[0]&#x3D; ip_forwarding</span><br><span class="line">NDD_VALUE[0]&#x3D;0</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<h2 id="2、关闭转发源路由包"><a href="#2、关闭转发源路由包" class="headerlink" title="2、关闭转发源路由包"></a>2、关闭转发源路由包</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ndd -get &#x2F;dev&#x2F;ip ip_forwarding</span><br></pre></td></tr></table></figure>

<p>查看是否关闭IP转发，返回值应为0</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ndd -set &#x2F;dev&#x2F;ip ip_forward_src_routed 0</span><br><span class="line">建立启动项，使参数重启后永久生效：</span><br><span class="line">cd &#x2F;etc&#x2F;rc.config.d</span><br><span class="line">cat &lt;&lt;EOF &gt;&gt; nddconf</span><br><span class="line"># Drop source-routed packets</span><br><span class="line">TRANSPORT_NAME[1]&#x3D;ip</span><br><span class="line">NDD_NAME[1]&#x3D;ip_forward_src_routed</span><br><span class="line">NDD_VALUE[1]&#x3D;0</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<h2 id="3、增大最大半连接数"><a href="#3、增大最大半连接数" class="headerlink" title="3、增大最大半连接数"></a>3、增大最大半连接数</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ndd -get &#x2F;dev&#x2F;tcp tcp_syn_rcvd_max</span><br></pre></td></tr></table></figure>

<p>查看返回值应最小为4096</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ndd -set &#x2F;dev&#x2F;tcp tcp_syn_rcvd_max 4096</span><br></pre></td></tr></table></figure>

<h2 id="4、关闭ICMP重定向"><a href="#4、关闭ICMP重定向" class="headerlink" title="4、关闭ICMP重定向"></a>4、关闭ICMP重定向</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ndd -get &#x2F;dev&#x2F;ip ip_send_redirects</span><br></pre></td></tr></table></figure>

<p>查看是否关闭ICMP重定向，返回值应为0</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ndd -set &#x2F;dev&#x2F;ip ip_send_redirects 0</span><br></pre></td></tr></table></figure>

<h2 id="5、关闭响应echo广播"><a href="#5、关闭响应echo广播" class="headerlink" title="5、关闭响应echo广播"></a>5、关闭响应echo广播</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ndd -get &#x2F;dev&#x2F;ip ip_forward_directed_broadcasts</span><br><span class="line">ndd -get &#x2F;dev&#x2F;ip ip_respond_to_echo_broadcast</span><br></pre></td></tr></table></figure>

<p>查看是否关闭IP转发，返回值应为0</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ndd -set &#x2F;dev&#x2F;ip ip_forward_directed_broadcasts 0</span><br><span class="line">ndd -set &#x2F;dev&#x2F;ip ip_respond_to_echo_broadcast 0</span><br></pre></td></tr></table></figure>

<h2 id="6、关闭响应地址掩码和时间戳广播防止探测"><a href="#6、关闭响应地址掩码和时间戳广播防止探测" class="headerlink" title="6、关闭响应地址掩码和时间戳广播防止探测"></a>6、关闭响应地址掩码和时间戳广播防止探测</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ndd -get &#x2F;dev&#x2F;ip ip_respond_to_address_mask_broadcast</span><br><span class="line"></span><br><span class="line">ndd -get &#x2F;dev&#x2F;ip ip_respond_to_timestamp_broadcast</span><br></pre></td></tr></table></figure>

<p>返回值应为0</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ndd -set &#x2F;dev&#x2F;ip ip_respond_to_address_mask_broadcast 0</span><br><span class="line">ndd -set &#x2F;dev&#x2F;ip ip_respond_to_timestamp_broadcast 0</span><br></pre></td></tr></table></figure>



<h1 id="0x09-其它"><a href="#0x09-其它" class="headerlink" title="0x09 其它"></a>0x09 其它</h1><p>​    作为管理人员，应当配置日志轮转工具，定期下载备份日志，这样不但能减少日志的消耗的磁盘空间，提高系统效率，更能及时发现问题，linux下有些很好的系统日志分析器可以拿来用。</p>
<p>​    另外，应当使主机处于单独（或隔离）的网络中。以防止未受保护的主机连接到其它网络，或在互联网中受到可能的攻击。</p>
<p>​    用下面的命令卸载一些不需要的软件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm –e softwarename</span><br></pre></td></tr></table></figure>

<p>​    卸载它们之前停掉三个进程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;etc&#x2F;rc.d&#x2F;init.d&#x2F;apmd stop &#x2F;&#x2F;电源管理</span><br><span class="line"></span><br><span class="line">&#x2F;etc&#x2F;rc.d&#x2F;init.d&#x2F;sendmail stop &#x2F;&#x2F;邮件发送</span><br><span class="line"></span><br><span class="line">&#x2F;etc&#x2F;rc.d&#x2F;init.d&#x2F;kudzu stop &#x2F;&#x2F;硬件自动检测程序</span><br></pre></td></tr></table></figure>

<p>​    另外，在安装系统时应该注意，如果用root分区记录数据，如log文件和email，就可能因为拒绝服务产生大量日志或垃圾邮件，从而导致系统崩溃。因此，最好为特殊的应用程序单独开一个分区，特别是可以产生大量日志的程序，以避免root分区被溢出。如/var,/home等。</p>
<p>​    至此，大部分可能存在安全隐患的点就被清除了。当然，主机安全中要做的远远不止这些，这些只是被动的、静态的防御，现实的主机安全还需要更多维度的考量。</p>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                </ul>
            
        </div>
        
    <div id='gitalk-container' class="comment link"
		data-enable='true'
        data-ae='true'
        data-ci='2b954438d2f5ca9e36a0'
        data-cs='e36607cd1943678e41a7095a67641166a303ec4e'
        data-r='guoyanan1g.github.io'
        data-o='guoyanan1g'
        data-a='guoyanan1g'
        data-d='false'
    >查看评论</div>


    </div>
    
        <div class='side'>
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-前言"><span class="toc-number">1.</span> <span class="toc-text">0x01 前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02-帐号管理"><span class="toc-number">2.</span> <span class="toc-text">0x02 帐号管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、密码设置"><span class="toc-number">2.1.</span> <span class="toc-text">1、密码设置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、shadow文件"><span class="toc-number">2.2.</span> <span class="toc-text">2、shadow文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、密码管理"><span class="toc-number">2.3.</span> <span class="toc-text">3、密码管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、账户清理"><span class="toc-number">2.4.</span> <span class="toc-text">4、账户清理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03-服务管理"><span class="toc-number">3.</span> <span class="toc-text">0x03 服务管理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x04-系统设置"><span class="toc-number">4.</span> <span class="toc-text">0x04 系统设置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、限制控制台的使用"><span class="toc-number">4.1.</span> <span class="toc-text">1、限制控制台的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、系统关闭Ping"><span class="toc-number">4.2.</span> <span class="toc-text">2、系统关闭Ping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、关闭或更改系统信息"><span class="toc-number">4.3.</span> <span class="toc-text">3、关闭或更改系统信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、etc-securetty文件"><span class="toc-number">4.4.</span> <span class="toc-text">4、etc&#x2F;securetty文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5、etc-host-conf文件"><span class="toc-number">4.5.</span> <span class="toc-text">5、etc&#x2F;host.conf文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6、禁止IP源路径路由"><span class="toc-number">4.6.</span> <span class="toc-text">6、禁止IP源路径路由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7、资源限制（防DDOS）"><span class="toc-number">4.7.</span> <span class="toc-text">7、资源限制（防DDOS）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8、LILO安全"><span class="toc-number">4.8.</span> <span class="toc-text">8、LILO安全</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9、Control-Alt-Delete键盘关机命令"><span class="toc-number">4.9.</span> <span class="toc-text">9、Control-Alt-Delete键盘关机命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10、日志系统安全"><span class="toc-number">4.10.</span> <span class="toc-text">10、日志系统安全</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11、修正脚本文件在-etc-rc-d-init-d”目录下的权限"><span class="toc-number">4.11.</span> <span class="toc-text">11、修正脚本文件在&#x2F;etc&#x2F;rc.d&#x2F;init.d”目录下的权限</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x05-文件系统"><span class="toc-number">5.</span> <span class="toc-text">0x05 文件系统</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、文件权限"><span class="toc-number">5.1.</span> <span class="toc-text">1、文件权限</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、控制mount上的文件系统"><span class="toc-number">5.2.</span> <span class="toc-text">2、控制mount上的文件系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、备份与恢复"><span class="toc-number">5.3.</span> <span class="toc-text">3、备份与恢复</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x06-iptables的使用"><span class="toc-number">6.</span> <span class="toc-text">0x06 iptables的使用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x07-日志管理"><span class="toc-number">7.</span> <span class="toc-text">0x07 日志管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、syslog登录事件"><span class="toc-number">7.1.</span> <span class="toc-text">1、syslog登录事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、syslog-conf的配置审核"><span class="toc-number">7.2.</span> <span class="toc-text">2、syslog.conf的配置审核</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、非日志服务器禁止接收syslog、"><span class="toc-number">7.3.</span> <span class="toc-text">3、非日志服务器禁止接收syslog、</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、启用inetd日志记录"><span class="toc-number">7.4.</span> <span class="toc-text">4、启用inetd日志记录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5、检查日志文件权限"><span class="toc-number">7.5.</span> <span class="toc-text">5、检查日志文件权限</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x08-协议配置"><span class="toc-number">8.</span> <span class="toc-text">0x08 协议配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、关闭IP转发"><span class="toc-number">8.1.</span> <span class="toc-text">1、关闭IP转发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、关闭转发源路由包"><span class="toc-number">8.2.</span> <span class="toc-text">2、关闭转发源路由包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、增大最大半连接数"><span class="toc-number">8.3.</span> <span class="toc-text">3、增大最大半连接数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、关闭ICMP重定向"><span class="toc-number">8.4.</span> <span class="toc-text">4、关闭ICMP重定向</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5、关闭响应echo广播"><span class="toc-number">8.5.</span> <span class="toc-text">5、关闭响应echo广播</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6、关闭响应地址掩码和时间戳广播防止探测"><span class="toc-number">8.6.</span> <span class="toc-text">6、关闭响应地址掩码和时间戳广播防止探测</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x09-其它"><span class="toc-number">9.</span> <span class="toc-text">0x09 其它</span></a></li></ol>	
        </div>
    
</div>


    </div>
</div>
</body>

<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>






</html>
